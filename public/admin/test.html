<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CMS Test Page</title>
  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
</head>
<body>
  <div id="loading">Loading CMS test page...</div>
  
  <script>
    console.log('Test: Starting to load CMS test page');
    
    // Check if config.yml is accessible
    fetch('/admin/config.yml')
      .then(response => {
        console.log('Config.yml response status:', response.status);
        if (response.ok) {
          return response.text();
        } else {
          throw new Error('Config.yml not found or not accessible');
        }
      })
      .then(configText => {
        console.log('Config.yml content loaded:', configText.substring(0, 200) + '...');
        
        // Try to parse YAML
        try {
          // Simple YAML format check
          if (configText.includes('backend:') && configText.includes('collections:')) {
            console.log('Config.yml appears to be valid YAML');
          } else {
            console.error('Config.yml missing required sections');
          }
        } catch (e) {
          console.error('Config.yml parsing error:', e);
        }
      })
      .catch(error => {
        console.error('Failed to load config.yml:', error);
      });
    
    // Wait for CMS to load
    window.addEventListener('load', function() {
      console.log('Test: Page loading completed');
      
      if (typeof window.DecapCMS !== 'undefined') {
        console.log('Test: DecapCMS object available');
        
        try {
          // Try to initialize CMS
          window.DecapCMS.init();
          console.log('Test: CMS initialization successful');
          
          document.getElementById('loading').innerHTML = 'CMS initialization successful!';
        } catch (error) {
          console.error('Test: CMS initialization failed:', error);
          document.getElementById('loading').innerHTML = 'CMS initialization failed: ' + error.message;
        }
      } else {
        console.error('Test: DecapCMS object not available');
        document.getElementById('loading').innerHTML = 'DecapCMS object not available';
      }
    });
  </script>
</body>
</html>